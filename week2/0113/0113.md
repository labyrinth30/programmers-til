# DB와 Docker, SQL
오늘은 쇼핑몰 프로젝트의 백엔드 부분을 구현하기 위해서 필수적으로 요하는 DB를 공부해볼거에요

## 데이터베이스란?
데이터를 통합하여 효율적으로 관리하기 위한 집합체를 DB라고 해요.
이런 DB를 구조화하여 관리함으로써 중복을 막고, 효율적이고 빠른 연산을 할 수 있어요.

## SQL이란?
데이터베이스에 연산을 요청하기 위해 사용되는 언어로 데이터 CRUD와 같은 기능을 수행할 수 있어요

## 도커란?
도커는 호스트 컴퓨터의 OS 위에서 독립적인 컨테이너를 기반으로 어플리케이션을 돌릴 수 있게하는 도구에요.
우리는 MariaDB를 도커로 띄워서 실습할거에요.

### 실습하기
```bash
docker pull mariadb ## mariadb 설치
docker runl --name mariadb -d -p 3306:3306 --restart=always -e MYSQL_ROOT_PASSWORD=root mariadb ## cli로 실행하기
docker exec -it mariadb /bin/bash ## 컨테이너 bash 쉘로 접속
mariadb -u root -p ## 실행
```
![](https://velog.velcdn.com/images/ayeon0/post/5b7ea583-5336-413f-8a97-2abe44150da0/image.png)
저는 도커 컴포즈로 띄우고
![](https://velog.velcdn.com/images/ayeon0/post/0acda69b-8918-405f-b5c0-19461ce27142/image.png)
`datagrip` gui를 사용해 실습을 진행할 예정이에요

## 데이터 조회 및 삽입
**데이터베이스 생성**: `CREATE DATABASE 테이블이름;`
**테이블 생성**
```sql
CREATE TABLE member (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(255),
    password VARCHAR(255)
)
```
다음과 같이 생성할 수 있어요.
**테이블 데이터 조회**: `SELECT 컬럼명 FROM 테이블명;`
**테이블 데이터 삽입**: `INSERT 컬럼명1, 컬럼명2, ...INTO 테이블명 VALUES (컬럼1 데이터, 컬럼2 데이터, ...`
![](https://velog.velcdn.com/images/ayeon0/post/e8be85f5-ce5c-4596-96ab-871b01fffbc9/image.png)
다음과 같이 성공적으로 데이터가 삽입된 것을 확인할 수 있어요.
**특정 데이터 조회**: `SELECT * FROM 테이블명 WHERE 조건;`
![](https://velog.velcdn.com/images/ayeon0/post/d809b7b3-74df-4813-9e0c-2c376f273d71/image.png)
**특정 데이터 수정**: `UPDATE 테이블명 SET 수정할 컬럼: '수정할 값' WHERE 조건;`
![](https://velog.velcdn.com/images/ayeon0/post/82307ccf-36d2-49be-a251-d56c1949fa87/image.png)
성공적으로 password가 수정된 걸 볼 수 있어요.
**특정 데이터 삭제**: `DELETE FROM 테이블명 WHERE 조건;`
![](https://velog.velcdn.com/images/ayeon0/post/8ea162f7-6380-458b-a74e-156a26a946ac/image.png)
이렇게 조건을 건 행이 삭제된 걸 볼 수 있어요.

## Node.js와 DB 연결하기
우선 테니스 제품에 대한 테이블을 설계해야해요
![](https://velog.velcdn.com/images/ayeon0/post/d680c771-2c4e-4a97-a919-e41570c279d1/image.png)
저는 이렇게 테이블을 만들었어요.

![](https://velog.velcdn.com/images/ayeon0/post/f7259822-44b3-41c0-a305-dd42fc0fda68/image.png)
필요한 라켓 3개를 DB에 넣었어요.
![](https://velog.velcdn.com/images/ayeon0/post/19706ac6-e87d-49b0-ad4f-26e1b579bd66/image.png)
`mysql` 라이브러리를 이용해서 node 서버랑 db 서버를 연결했어요.
![](https://velog.velcdn.com/images/ayeon0/post/cafceaa6-c194-45ce-979b-f9a1f0caf8ff/image.png)
`request handler`를 통해 mariadb에 쿼리를 날릴 수 있어요(repository의 역할)
![](https://velog.velcdn.com/images/ayeon0/post/5fa865bf-5bd8-483f-b816-416d8f3b8e91/image.png)
이제 `localhost:3000`으로 들어오면 메인페이지와 함께 콘솔에 `select` 쿼리가 날아가요.

## 라켓 주문 및 주문 목록 조회하기
![](https://velog.velcdn.com/images/ayeon0/post/b8ef2b88-3318-40f3-a051-a722912be85d/image.png)
order가 호출되면 sql을 직접 호출해서 db와 통신해요
이와같이 orm 없이 작업하는 건 처음인데, 왜 sql injection이 위험한지 알 것 같아요.
![](https://velog.velcdn.com/images/ayeon0/post/9c37ded5-69e0-4539-98aa-1d88ec6f57ff/image.png)
main 페이지에서 주문하기를 눌렀더니 성공적으로 데이터가 들어왔어요.
![](https://velog.velcdn.com/images/ayeon0/post/ca0970da-96d5-42e5-a0d7-86665f718e21/image.png)
들어온 데이터가 Order List 페이지에서 보이는 모습이에요.